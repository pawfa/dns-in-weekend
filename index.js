const {sendPacket} = require('./udp.js')
const {BufferReader} = require('./reader.js')
const {DNSPacket, DNSHeader, DNSQuestion} = require('./dns-models.js')

const header = new DNSHeader(18672, 1);
const question = new DNSQuestion("www.yahoo.com",1,1);

const packet = new DNSPacket(header, [question])

const responseBytes = Buffer.from([0xdc,0x62,0x81,0x80,0x00,0x01,0x00,0x03,0x00,0x00,0x00,0x00,0x03,0x77,0x77,0x77,0x05,0x79,0x61,0x68,0x6f,0x6f,0x03,0x63,0x6f,0x6d,0x00,0x00,0x01,0x00,0x01,0xc0,0x0c,0x00,0x05,0x00,0x01,0x00,0x00,0x00,0x31,0x00,0x21,0x0e,0x6d,0x65,0x2d,0x79,0x63,0x70,0x69,0x2d,0x63,0x66,0x2d,0x77,0x77,0x77,0x03,0x67,0x30,0x36,0x08,0x79,0x61,0x68,0x6f,0x6f,0x64,0x6e,0x73,0x03,0x6e,0x65,0x74,0x00,0xc0,0x2b,0x00,0x01,0x00,0x01,0x00,0x00,0x00,0x31,0x00,0x04,0x57,0xf8,0x77,0xfc,0xc0,0x2b,0x00,0x01,0x00,0x01,0x00,0x00,0x00,0x31,0x00,0x04,0x57,0xf8,0x77,0xfb])

sendPacket(packet.writeToBytes(), (message)=> {
    // console.log(message)
    console.log(responseBytes)
    const myBuffer = new BufferReader(responseBytes)

    console.log(DNSPacket.readFromBytes(myBuffer));
})

module.exports = {DNSHeader, DNSPacket, DNSQuestion};

/*


*/